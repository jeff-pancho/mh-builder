(this["webpackJsonpmh-builder"]=this["webpackJsonpmh-builder"]||[]).push([[0],{14:function(t,e,n){},15:function(t,e,n){"use strict";n.r(e);var i=n(0),r=n.n(i),a=n(7),o=n.n(a),u=(n(14),n(8)),s=n(1),l=n(2),c=n(4),h=n(3),d=n(5),g=function(t){var e=t.row,n=t.column,i=t.width,a=t.height,o={backgroundColor:t.colour,gridColumn:n+1+" / span "+i,gridRow:e+1+" / span "+a};return r.a.createElement("div",{className:"building",style:o})},m=46,b=46,f=[{name:"conveyor",width:2,height:2,colour:"#262626"},{name:"large conveyor ramp",width:5,height:2,colour:"#3D3D3D"},{name:"iron mine",width:2,height:2,colour:"#777777"},{name:"furnace",width:2,height:2,colour:"#C76D6D"},{name:"azure refiner",width:4,height:6,colour:"#2FB3F5"},{name:"portable ore advancer",width:3,height:2,colour:"#8C17EB"},{name:"big bad blaster",width:3,height:2,colour:"#DE7914"},{name:"tesla resetter",width:8,height:6,colour:"#D3D61C"}],v=function(t,e){var n="";return n+="linear-gradient(to right, ",n+="transparent "+(t-1)+"px, ",n+="black "+(t-1)+"px, ",n+="black "+t+"px), ",n+="linear-gradient(to bottom, ",n+="transparent "+(t-1)+"px, ",n+="black "+(t-1)+"px, ",n+="black "+t+"px)"},p=function(t,e){return Array(e).fill().map((function(){return Array(t).fill(null)}))},k=function(t,e,n,i,r){for(var a=e+r,o=n+i,u=e;u<a;u++)for(var s=n;s<o;s++)if(u>t.length-1||s>t[u].length-1||null!==t[u][s])return!1;return!0},y=function(t){function e(){return Object(s.a)(this,e),Object(c.a)(this,Object(h.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(l.a)(e,[{key:"renderBuilding",value:function(t,e,n){var i=this,a=t.row,o=t.column,u=e?"ghost":"".concat(a,",").concat(o);return r.a.createElement(g,Object.assign({key:u,buildingId:n,onClick:function(){return i.props.removeBuilding(n)}},t))}},{key:"render",value:function(){var t=this,e={width:15*m,height:15*b,backgroundImage:v(15),backgroundSize:"15px 15px",gridTemplateColumns:"repeat("+m+", 15px)",gridTemplateRows:"repeat("+b+", 15px)"},n=this.props.buildings.filter((function(t){return null!==t})).map((function(e,n){return t.renderBuilding(e,!1,n)}));return n.push(this.renderBuilding(this.props.buildingGhost,!0)),r.a.createElement("div",{className:"grid",style:e,onClick:function(e){return t.props.onClick(e)},onMouseMove:function(e){return t.props.onMouseMove(e)},onContextMenu:function(e){return t.props.onContextMenu(e)}},n)}}]),e}(r.a.Component),N=function(t){var e=t.onClick,n=f.map((function(t,n){var i=t.colour;return r.a.createElement("div",{key:n,className:"square",style:{backgroundColor:i},onClick:function(){return e(t)}})}));return r.a.createElement("div",{className:"picker-container"},n)},C=function(t){var e=t.handleRotate,n=t.handleUndo,i=t.handleRedo,a=t.handleClear;return r.a.createElement("div",{className:"buttons-container"},r.a.createElement("button",{onClick:function(){return e()}},"Rotate"),r.a.createElement("button",{onClick:function(){return n()}},"Undo"),r.a.createElement("button",{onClick:function(){return i()}},"Redo"),r.a.createElement("button",{onClick:function(){return a()}},"Clear"))},w=function(t){var e=t.children;return r.a.createElement("div",{className:"builder-container"},e)},B=function(t){function e(t){var n;return Object(s.a)(this,e),(n=Object(c.a)(this,Object(h.a)(e).call(this,t))).state={history:[{buildings:[],grid:p(m,b)}],currentBuilding:f[0],mousePos:{row:0,column:0},buildingGhost:f[0],stateNumber:0},n}return Object(d.a)(e,t),Object(l.a)(e,[{key:"createBuilding",value:function(t,e,n){return Object(u.a)({row:t,column:e},n)}},{key:"handleOnClick",value:function(){var t=this.state.currentBuilding,e=t.width,n=t.height,i=this.state.mousePos,r=i.row,a=i.column,o=r+n,u=a+e,s=this.state.history.slice(0,this.state.stateNumber+1),l=JSON.parse(JSON.stringify(s[this.state.stateNumber])),c=l.grid.slice();if(k(c,r,a,e,n)){for(var h=l.buildings.slice(),d=r;d<o;d++)for(var g=a;g<u;g++)c[d][g]=h.length;h=h.concat([this.createBuilding(r,a,this.state.currentBuilding)]),this.setState({history:s.concat([{buildings:h,grid:c}]),stateNumber:this.state.stateNumber+1,buildingGhost:this.renderBuildingGhost(r,a)})}}},{key:"handleOnMouseMove",value:function(t){var e=function(t){var e=t.currentTarget.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}(t),n=e.x,i=e.y,r=Math.floor(i/15),a=Math.floor(n/15),o=this.state.mousePos,u=o.row,s=o.column;r===u&&a===s||this.setState({mousePos:{row:r,column:a},buildingGhost:this.renderBuildingGhost(r,a)})}},{key:"handleRemoveBuilding",value:function(t){t.preventDefault();var e=this.state.history.slice(0,this.state.stateNumber+1),n=JSON.parse(JSON.stringify(e[this.state.stateNumber])),i=n.grid.slice(),r=this.state.mousePos,a=r.row,o=r.column,u=i[a][o];if(null!==u){for(var s=n.buildings.slice(),l=s[u],c=l.row,h=l.column,d=l.width,g=c+l.height,m=h+d,b=c;b<g;b++)for(var f=h;f<m;f++)i[b][f]=null;s[u]=null,this.setState({history:e.concat([{buildings:s,grid:i}]),stateNumber:this.state.stateNumber+1,buildingGhost:this.renderBuildingGhost(a,o)})}}},{key:"handlePicker",value:function(t){this.setState({currentBuilding:t})}},{key:"renderBuildingGhost",value:function(t,e){var n=this.state.history.slice(0,this.state.stateNumber+1)[this.state.stateNumber].grid.slice(),i=this.state.currentBuilding,r=i.width,a=i.height,o=this.createBuilding(t,e,this.state.currentBuilding);return k(n,t,e,r,a)||(o.colour="#8a0000"),o}},{key:"handleUndo",value:function(){this.state.stateNumber>0&&this.setState({stateNumber:this.state.stateNumber-1})}},{key:"handleRedo",value:function(){this.state.stateNumber<this.state.history.length-1&&this.setState({stateNumber:this.state.stateNumber+1})}},{key:"handleClear",value:function(){var t=this.state.history.slice(0,this.state.stateNumber+1);this.setState({history:t.concat([{buildings:[],grid:p(m,b)}]),stateNumber:this.state.stateNumber+1})}},{key:"handleRotate",value:function(){var t=JSON.parse(JSON.stringify(this.state.currentBuilding)),e=t.width;t.width=t.height,t.height=e,this.setState({currentBuilding:t})}},{key:"render",value:function(){var t=this,e=this.state.history[this.state.stateNumber];return r.a.createElement(w,null,r.a.createElement(y,{buildings:e.buildings,buildingGhost:this.state.buildingGhost,onClick:function(){return t.handleOnClick()},onMouseMove:function(e){return t.handleOnMouseMove(e)},onContextMenu:function(e){return t.handleRemoveBuilding(e)}}),r.a.createElement(N,{onClick:function(e){return t.handlePicker(e)}}),r.a.createElement(C,{handleRotate:function(){return t.handleRotate()},handleUndo:function(){return t.handleUndo()},handleRedo:function(){return t.handleRedo()},handleClear:function(){return t.handleClear()}}))}}]),e}(r.a.Component);o.a.render(r.a.createElement(B,null),document.getElementById("root"))},9:function(t,e,n){t.exports=n(15)}},[[9,1,2]]]);
//# sourceMappingURL=main.97ac4c47.chunk.js.map